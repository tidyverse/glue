<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Custom knitr language engines • glue</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Custom knitr language engines">
<meta name="robots" content="noindex">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script><script defer data-domain="glue.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glue</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.8.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/glue.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/engines.html">Custom knitr language engines</a></li>
    <li><a class="dropdown-item" href="../articles/speed.html">Speed of glue</a></li>
    <li><a class="dropdown-item" href="../articles/transformers.html">Transformers</a></li>
    <li><a class="dropdown-item" href="../articles/wrappers.html">How to write a function that wraps glue</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2017/10/glue-1.2.0/">glue 1.2.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/glue/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Custom knitr language engines</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/glue/blob/main/vignettes/engines.Rmd" class="external-link"><code>vignettes/engines.Rmd</code></a></small>
      <div class="d-none name"><code>engines.Rmd</code></div>
    </div>

    
    
<p>Glue provides a few <a href="https://bookdown.org/yihui/rmarkdown-cookbook/custom-engine.html#custom-engine" class="external-link">custom
language engines</a> for knitr, which allows you to use glue directly in
knitr chunks.</p>
<div class="section level2">
<h2 id="glue-engine">
<code>glue</code> engine<a class="anchor" aria-label="anchor" href="#glue-engine"></a>
</h2>
<p>The first engine is the <code>glue</code> engine, which evaluates the
chunk contents as a glue template.</p>
<pre class="glue"><code><span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">=</span> <span class="op">{</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">}</span></span></code></pre>
<pre><code><span><span class="co">## 1 + 1 = 2</span></span></code></pre>
<p>Maybe the most useful use of the <code>glue</code> engine is to set
the knitr option <code>results = 'asis'</code> and output markdown or
HTML directly into the document.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="in">```{glue, results = 'asis', echo = FALSE}</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="in">#### mtcars has **{nrow(mtcars)} rows** and _{ncol(mtcars)} columns_.</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<div class="section level4">
<h4 id="mtcars-has-32-rows-and-11-columns-">mtcars has <strong>32 rows</strong> and <em>11 columns</em>.<a class="anchor" aria-label="anchor" href="#mtcars-has-32-rows-and-11-columns-"></a>
</h4>
<p>If you want to pass additional arguments into the glue call, simply
include them as chunk options.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="in">```{glue, .open = "&lt;&lt;", .close = "&gt;&gt;", results = 'asis', echo = FALSE}</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="in">The **median waiting time** between eruptions is &lt;&lt;median(faithful$waiting)&gt;&gt;.</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>The <strong>median waiting time</strong> between eruptions is 76.</p>
</div>
</div>
<div class="section level2">
<h2 id="glue_sql-engine">
<code>glue_sql</code> engine<a class="anchor" aria-label="anchor" href="#glue_sql-engine"></a>
</h2>
<p>The second engine is <code>glue_sql</code>, which will use
<code><a href="../reference/glue_sql.html">glue::glue_sql()</a></code> to generate a SQL query and then run the
query using the <a href="https://bookdown.org/yihui/rmarkdown/language-engines.html#sql" class="external-link">sql
engine</a>.</p>
<p>First we create a new connection to an in-memory SQLite database, and
write a new table to it.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">":memory:"</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"mtcars"</span>, <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<p>Next define some variables we that we can use with glue to
interpolate.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="st">"mpg"</span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="st">"mtcars"</span></span>
<span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">150</span></span></code></pre></div>
<p>Then we can use <code>glue_sql</code> to construct and run a query
using those variables into that database. <em>Note</em> you need to
provide the connection object as a <code>connection</code> chunk
option.</p>
<p>In this example there are two type of quotes. The first is a bare
backtick, these are passed directly to the SQL engine unchanged. The
second is backticks inside of braces, which are specially interpreted to
do the proper quoting for the given SQL engine by glue. In this example
we use the <code>sqlite</code> engine, which uses backticks for quoting,
but you would use the same backticks inside brace syntax for postgreSQL,
and <code><a href="../reference/glue_sql.html">glue_sql()</a></code> would automatically use double quotes for
quoting instead.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="in">```{glue_sql, connection = con}</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="in">SELECT `model`, `hp`, {`var`}</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="in">FROM {`tbl`}</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="in">WHERE {`tbl`}.`hp` &gt; {num}</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="kw">SELECT</span> `model`, `hp`, `mpg`</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="kw">FROM</span> `mtcars`</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="kw">WHERE</span> `mtcars`.`hp` <span class="op">&gt;</span> <span class="dv">150</span></span></code></pre></div>
<div class="knitsql-table">
<table class="table">
<caption>Displaying records 1 - 10</caption>
<thead><tr class="header">
<th align="left">model</th>
<th align="right">hp</th>
<th align="right">mpg</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Hornet Sportabout</td>
<td align="right">175</td>
<td align="right">18.7</td>
</tr>
<tr class="even">
<td align="left">Duster 360</td>
<td align="right">245</td>
<td align="right">14.3</td>
</tr>
<tr class="odd">
<td align="left">Merc 450SE</td>
<td align="right">180</td>
<td align="right">16.4</td>
</tr>
<tr class="even">
<td align="left">Merc 450SL</td>
<td align="right">180</td>
<td align="right">17.3</td>
</tr>
<tr class="odd">
<td align="left">Merc 450SLC</td>
<td align="right">180</td>
<td align="right">15.2</td>
</tr>
<tr class="even">
<td align="left">Cadillac Fleetwood</td>
<td align="right">205</td>
<td align="right">10.4</td>
</tr>
<tr class="odd">
<td align="left">Lincoln Continental</td>
<td align="right">215</td>
<td align="right">10.4</td>
</tr>
<tr class="even">
<td align="left">Chrysler Imperial</td>
<td align="right">230</td>
<td align="right">14.7</td>
</tr>
<tr class="odd">
<td align="left">Camaro Z28</td>
<td align="right">245</td>
<td align="right">13.3</td>
</tr>
<tr class="even">
<td align="left">Pontiac Firebird</td>
<td align="right">175</td>
<td align="right">19.2</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.jimhester.com/" class="external-link">Jim Hester</a>, <a href="https://jennybryan.org" class="external-link">Jennifer Bryan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer>
</body>
</html>
